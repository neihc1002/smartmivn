jQuery(document).ready(function(e){WP_Optimize_Premium=WP_Optimize_Premium()});var WP_Optimize_Premium=function(){function e(e,i,t){return i||(i={}),i.images_trash_command=e,E("images_trash_command",i,t)}function i(e){var i=j("#wp-optimize-wrap .nav-tab-wrapper .nav-tab-active").is(["#wp-optimize-nav-tab-",e].join(""));return console.log(["Checking if ",e," active. Result: ",i?"TRUE":"FALSE"].join("")),i}function t(){te||(te=!0,ee.show(),ie.hide(),p())}function o(i){return a(!0),i||(i=ee.get_selected_images()),e("move_images_to_trash",{images:i},function(e){alert(e.message),a(!1),Z.trigger("click"),A.data("dirty",!0)})}function n(i,t){return a(!0),i||(i=ie.get_selected_images()),e("remove_trash_images",{images:i},function(e){e.error?alert(e.error):e.message&&(alert(e.message),t?t.remove():ie.reload()),a(!1)})}function s(i,t){return a(!0),i||(i=ie.get_selected_images()),e("restore_images_from_trash",{images:i},function(e){e.error?alert(e.error):e.message&&(alert(e.message),F.data("dirty",!0),t?t.remove():ie.reload()),a(!1)})}function a(e){var i=j("#optimization_checkbox_images");j.each([R,G,j("#optimization_button_images_big"),j("#optimization_button_images_small"),i,Z,L,D,U],function(i,t){t.prop("disabled",e)}),e?(oe=i.is(":checked"),i.prop("checked",!1)):(i.prop("checked",oe),ee.update_view(),ie.update_view())}function p(){console.log("Loading information about unused images."),j(document).trigger(de.GET_INFO_START),I(Q,"images",{support_ajax_get_info:!0}).fail(function(){j(document).trigger(de.GET_INFO_DONE,{})})}function _(){var e=P(),i=ne.hasOwnProperty(e)?ne[e]:0;if(0!=i&&(!pe.hasOwnProperty(e)||re.BUSY!==pe[e]&&re.COMPLETE!==pe[e])){j("#wpo_unused_images_loader_bottom").css("visibility","visible"),pe[e]=re.BUSY;var t={optimization_id:"images",data:{blog_id:e,length:ae,offset:i}};E("get_optimization_info",t,function(i){var t=m(i.result.meta);d(P()),t==ae?pe[e]=re.SUCCESS:pe[e]=re.COMPLETE,j("#wpo_unused_images_loader_bottom").css("visibility","hidden"),ee.update_view()}).fail(function(){pe[e]=re.FAILURE,j("#wpo_unused_images_loader_bottom").css("visibility","hidden")})}}function r(){var i=P(),t=ie.get_images_count(i);if(!_e.hasOwnProperty(i)||re.BUSY!==_e[i]&&re.COMPLETE!==_e[i])return _e[i]=re.BUSY,j("#wpo_unused_images_loader_bottom").css("visibility","visible"),0==t&&(j("#wp-optimize-nav-tab-wpo_images-unused-contents .wpo_shade").show(),H.html("")),e("get_trash_images",{offset:t,length:ae,blog_id:i},function(e){if(j("#wpo_unused_images_loader_bottom").css("visibility","hidden"),j("#wp-optimize-nav-tab-wpo_images-unused-contents .wpo_shade").hide(),e.errors)return void alert(e.errors.join("\n"));var t,o,n,s;for(t in e.images)e.images.hasOwnProperty(t)&&(o=e.images[t][0],s=e.images[t].length>1?[e.images[t][0]," [id:",e.images[t][1]," ]"].join(""):e.images[t][0],n=[e.base_url,e.images[t][0]].join(""),ie.append_image(i,o,n,n,s,s));e.images&&e.images.length===ae?_e[i]=re.SUCCESS:_e[i]=re.COMPLETE,ie.update_view()})}function d(e){se.hasOwnProperty(e)&&j("#wpo_unused_images_loaded_count").text(se[e])}function u(e,i){e.result&&e.result.hasOwnProperty("meta")&&e.result.meta?i&&i(e.result.meta):alert(wpoptimize.error_unexpected_response)}function l(e){var i=!e.hasOwnProperty("removed_message");if(i&&W.text(""),e&&e.hasOwnProperty("unused_images")){var t,o="",n=!1,s=$.val();i&&m(e),$.html("");for(t in e.unused_images)e.unused_images.hasOwnProperty(t)&&(e.images_loaded_text.hasOwnProperty(t)&&(se[t]=e.images_loaded_text[t]),e.multisite&&(n=!0,o=[e.sites[t].domain,e.sites[t].path].join(""),$.append(['<option value="',t,'">',o,0==e.unused_images[t].length?" ("+wpoptimize.no_unused_images+")":"","</option>"].join(""))))}e&&0===e.files&&(se[P()]="",pe[P()]=re.COMPLETE),n?(V.show(),s&&$.val(s),h($.val())):V.hide(),c(e),d(P())}function c(e){g(j("#registered_image_sizes"),w(e.image_sizes,"used",!0),wpoptimize.no_registered_image_sizes),g(j("#unused_image_sizes"),w(e.image_sizes,"used",!1),wpoptimize.no_unsed_image_sizes),j("#registered_image_sizes, #unused_image_sizes").on("change",'input[type="checkbox"]',function(){O()}),O()}function m(e){var i,t,o=0,n="",s="",a="",p={};for(o in e.unused_images)if(e.unused_images.hasOwnProperty(o)){e.images_loaded_text.hasOwnProperty(o)&&(se[o]=e.images_loaded_text[o]),n=e[["baseurl_",o].join("")],s=e[["adminurl_",o].join("")],t=0;for(i in e.unused_images[o])e.unused_images[o].hasOwnProperty(i)&&(t++,p=e.unused_images[o][i],e.multisite&&(a=[e.sites[o].domain,e.sites[o].path].join("")),v(p,n,s,o,a));ne.hasOwnProperty(o)?ne[o]+=t:ne[o]=t}return t}function h(e){ee.filter_by_site(e),ie.is_visible()&&ie.reload()}function w(e,i,t){var o,n=[];for(o in e)e.hasOwnProperty(o)&&e[o].hasOwnProperty(i)&&t==e[o][i]&&(n[o]=e[o]);return n}function g(e,i,t){var o,n=!0;if(e.text(""),i)for(o in i)i.hasOwnProperty(o)&&(e.append(['<label for="chk_',o,'" class="unused-image-sizes__label"><input type="checkbox" id="chk_',o,'" class="unused-image-sizes" name="',o,'">',o," (",i[o].size_formatted," - Total: ",i[o].files,")</lalbel><br>"].join("")),n=!1);n?(j(".hide_on_empty",e.parent()).hide(),e.append(["<i>",t,"</i>"].join(""))):j(".hide_on_empty",e.parent()).show()}function v(e,i,t,o,n){var s=[o,e.id?e.id:e.url].join("_"),a=e.id?[t,"post.php?post=",e.id,"&action=edit"].join(""):[i,"/",e.url].join(""),p=e.id?["#",e.id].join(""):e.url,_=[i,"/",e.url].join(""),r=[i,"/",e.id&&e.url?e.url.replace(/(\-[0-9]+x[0-9]+)(\.[a-z]+)$/i,"$2"):e.url,e.id?[" [id: ",e.id,"]"].join(""):""].join("");n&&(p=[p," [",n,"]"].join("")),ee.append_image(o,s,a,_,p,r)}function f(e){ee.switch_view_mode(e),ie.switch_view_mode(e)}function b(){var e=[];e=0==j("#wpo_unused_images input:not(:checked)").length&&re.COMPLETE==pe[P()]?"all":ee.get_selected_images(),0!=e.length&&z(e)}function z(e){return j(document).trigger(de.OPTIMIZATION_START),E("do_optimization",{optimization_id:"images",data:{selected_images:e,images_loaded:ne}},function(i){var t,o,n,s;for(t in e)e.hasOwnProperty(t)&&(n=e[t],o=j(['#wpo_unused_images input[value="',n,'"'].join("")),s=n.split("_").shift(),ne[s]--,o.closest(".wpo_unused_image").remove());j(document).trigger(de.OPTIMIZATION_DONE,i),ee.load_next_page_if_need()}).fail(function(){alert(wpoptimize.error_unexpected_response)})}function y(){var e=[];return j('#registered_image_sizes input[type="checkbox"], #unused_image_sizes input[type="checkbox"]').each(function(){var i=j(this);i.is(":checked")&&e.push(i.prop("name"))}),e}function k(){var e=y();if(!G.prop("disabled")&&e&&0!=e.length){var i=j("#registered_image_sizes"),t=j("#unused_image_sizes"),o=i.parent(),n=j(".wpo_unused_images_loader",o);a(!0),n.show(),E("do_optimization",{optimization_id:"images",data:{selected_sizes:e}},function(e){u(e,function(e){g(i,w(e.image_sizes,"used",!0),wpoptimize.no_registered_image_sizes),g(t,w(e.image_sizes,"used",!1),wpoptimize.no_used_image_sizes)}),a(!1),O(),n.hide(),alert(e.result.meta.removed_message)}).fail(function(){a(!1),O(),n.hide(),alert(wpoptimize.error_unexpected_response)})}}function O(){var e=j("#registered_image_sizes"),i=j("#unused_image_sizes");j('input[type="checkbox"]:checked',e).length+j('input[type="checkbox"]:checked',i).length>0?G.prop("disabled",!1):G.prop("disabled",!0)}function P(){return $.length&&$.val()?$.val():1}function x(e){var i="";i=j("#wpo_lazy_load_settings input[type='text'], #wpo_lazy_load_settings input[type='radio']").serialize(),j.each(j("#wpo_lazy_load_settings input[type='checkbox']"),function(){var e=j(this).prop("checked")?"1":"0";i+="&"+j(this).attr("name")+"="+e}),E("save_lazy_load_settings",i,function(i){j("body").trigger("wpo_purge_cache"),e&&e(i)})}function T(e){var i=e.id,t=e.title,o=j("#wpo-popup-preview"),n=['<table id="wpo-preview-tablesorter" cellspacing="1" class="tablesorter"></table>','<h4 id="wpo-preview-message" style="display: none;"></h4>'].join(""),s=['<div id="pager" class="pager" style="display: none">','<span class="first dashicons dashicons-controls-skipback"></span>','<span class="prev dashicons dashicons-controls-back"></span>','<input type="text" class="pagedisplay">','<span class="pagedisplay-count"></span>','<span class="next dashicons dashicons-controls-forward"></span>','<span class="last dashicons dashicons-controls-skipforward"></span>','<select class="pagesize">','<option value="50">50</option>','<option value="100">100</option>','<option value="200">200</option>','<option value="300">300</option>','<option value="400">400</option>','<option value="500">500</option>',"</select>","</div>"].join(""),a="",p=[],_={};if("undefined"!=typeof wpoptimize.sites&&wpoptimize.sites.length){for(var r in wpoptimize.sites)wpoptimize.sites.hasOwnProperty(r)&&p.push(['<option value="',wpoptimize.sites[r].blog_id,'">',wpoptimize.sites[r].domain,wpoptimize.sites[r].path,"</option>"].join(""));a=['<select id="wpo-preview-site" style="display: none">',p.join(""),"</select>"].join("")}_[wpoptimize.delete_selected_items_btn]=function(){var t=[],o=j("#wpo-preview-tablesorter");if(j("input:checkbox:checked",o).each(function(){j(this).is("#wpo-select-all-preview-rows")||t.push(j(this).val())}),0!=t.length){var n=e;n.ids=t,j("#wpo-preview-site").length&&(n.site_id=j("#wpo-preview-site").val()),d.show(),wp_optimize.send_command("do_optimization",{optimization_id:i,data:n},function(e){j("#wpo-preview-tablesorter").trigger("reload"),j("#wpo-select-all-preview-rows").prop("checked",!1),E("get_optimization_info",{optimization_id:i},function(e){var t=(e&&e.result&&e.result.meta?e.result.meta:{},e&&e.result&&e.result.output?e.result.output.join("<br>"):""),o={};if(""!=t){j(["#optimization_info_",i,' input[type="checkbox"]'].join("")).each(function(){o[j(this).attr("name")]=j(this).prop("checked")}),j(["#optimization_info_",i].join("")).html(t);for(var n in o)o.hasOwnProperty(n)&&j(["#optimization_info_",i,' input[name="',n,'"]'].join("")).prop("checked",o[n])}})})}},_[wpoptimize.close_btn]=function(){j(this).dialog("destroy")},o.dialog({autoOpen:!1,title:t,minWidth:800,minHeight:400,modal:!0,close:function(){j(this).dialog("destroy"),j("#wpo-popup-preview").html("")},buttons:_}),j("#wpo-preview-tablesorter").hide(),o.html(n),j(".ui-dialog-buttonpane button").first().hide(),j(".ui-dialog-buttonpane").prepend([s,a].join("")),j(".ui-dialog-title").append(['<i id="wpo-preview-loader"><img width="12" height="12" src="',wpoptimize.spinner_src,'" /></i>'].join(""));var d=j("#wpo-preview-loader > img"),u=j("#wpo-preview-site"),l=new TableSorter_DataSource({optimization_id:i,limit:1});for(var r in e)e.hasOwnProperty(r)&&"id"!=r&&"title"!=r&&l.set_option(r,e[r]);u.length&&u.val()&&l.set_option("site_id",u.val()),u.change(function(){l.set_option("site_id",u.val()),j("#wpo-preview-tablesorter").trigger("reload")}),l.fetch().done(function(e){var i=j("#wpo-preview-tablesorter");try{e=wpo_parse_json(e)}catch(t){return void alert(wpoptimize.error_unexpected_response)}i.hide();var o,n=[],s=[],a=1,p={0:{sorter:!1}};n.push('<th style="width: 20px"><input id="wpo-select-all-preview-rows" type="checkbox" /></th>'),s.push("<th></th>");for(o in e.result.columns)e.result.columns.hasOwnProperty(o)&&(p[a]={sorter:!1},a++,n.push(['<th class="header">',e.result.columns[o],"</th>"].join("")),s.push(["<th>",e.result.columns[o],"</th>"].join("")));i.append(["<thead><tr>",n,"</tr></thead>"].join("")),i.append(["<tfoot><tr>",s,"</tr></tfoot>"].join("")),i.append("<tbody></tbody>");var _=j("#pager");i.tablesorter({widthFixed:!0,widgets:["zebra"],headers:p}).tablesorterPager({container:_,size:parseInt(j(".pagesize",_).val()),dataSource:l}),i.on("load_start",function(){d.show()}),i.on("load_end",function(e,i){d.hide(),parseInt(i.result.total)>0?(j("#wpo-preview-tablesorter").show(),j("#wpo-preview-message").hide(),j(".ui-dialog-buttonpane #pager").show(),j(".ui-dialog-buttonpane button").first().show()):(j("#wpo-preview-tablesorter").hide(),j("#wpo-preview-message").text(i.result.message).show(),j(".ui-dialog-buttonpane #pager").hide(),j(".ui-dialog-buttonpane button").first().hide()),j("#wpo-preview-site").show()})}),o.dialog("open")}var j=jQuery,E=WP_Optimize.send_command,I=WP_Optimize.optimization_get_info,S=WP_Optimize.take_a_backup_with_updraftplus,C=WP_Optimize.save_auto_backup_options;console.log("Loading WP-O Premium");var N=j("#wp-optimize-nav-tab-wpo_images-unused-contents"),W=j("#wpo_unused_images"),M=j("#wpo_unused_images_trash"),F=j("#wpo_unused_images_view_images_btn"),A=j("#wpo_unused_images_view_trash_btn"),D=j("#wpo_restore_unused_images_from_trash_btn"),H=j("#wpo_shade_progress_message"),R=j("#wpo_remove_unused_images_btn"),L=j("#wpo_move_unused_images_to_trash_btn"),U=j("#wpo_remove_unused_images_from_trash_btn"),G=j("#wpo_remove_selected_sizes_btn"),Z=j("#wpo_unused_images_refresh"),B=j("#wpo_unused_images_select_all"),Y=j("#wpo_unused_images_select_none"),Q=j("#optimization_info_images"),V=j("#wpo_unused_images_sites_select_container"),$=j("#wpo_unused_images_sites_select"),q=j("#enable-auto-backup-2"),J=j("#enable-auto-backup-3"),K=wpoptimize.sites.length>1?[j("#wpo_unused_images_loaded_count")]:[j("#wpo_unused_images_control_panel"),j("#wpo_unused_images_loaded_count")],X=wpoptimize.sites.length>1?[]:[j("#wpo_unused_images_control_panel")],ee=new WP_Optimize_Images_View({container:W,no_images_found_message:wpoptimize.no_unused_images_found,related_elements:[j(".wpo-unused-images-el"),j(".wpo-image-sizes-section"),j("#wpo_unused_images_loaded_count"),j("#wpo_unused_images_refresh")],row_action_buttons:[{"class":"wpo_unused_images_move_to_trash_single button button-primary",title:wpoptimize.trash,hint:wpoptimize.move_to_trash},{"class":"wpo_unused_images_remove_single button button-link button-link-delete",title:wpoptimize["delete"],hint:wpoptimize.permanently_delete}],action_buttons:[R,L],hide_when_empty:K,load_next_page_callback:_}),ie=new WP_Optimize_Images_View({container:M,no_images_found_message:wpoptimize.no_unused_trash_images_found,related_elements:[j(".wpo-unused-images-trash-el")],row_action_buttons:[{"class":"wpo_unused_images_restore_from_trash_single button",title:wpoptimize.restore,hint:wpoptimize.restore_from_trash},{"class":"wpo_unused_images_remove_single_from_trash button button-primary",title:wpoptimize["delete"],hint:wpoptimize.permanently_delete}],action_buttons:[D,U],hide_when_empty:X,load_next_page_callback:r,onclear:function(){_e[P()]=""}}),te=!1,oe=!1,ne={},se={},ae=wpoptimize.unused_images_per_page,pe={},_e={},re={COMPLETE:"complete",SUCCESS:"success",FAILURE:"failure",BUSY:"busy"},de={GET_INFO_START:"optimization_get_info_images_start",GET_INFO_PROCESS:"optimization_get_info_images",GET_INFO_DONE:"optimization_get_info_images_done",OPTIMIZATION_START:"do_optimization_images_start",OPTIMIZATION_DONE:"do_optimization_images_done"};A.on("click",function(){return A.hide(),F.show(),A.data("dirty")&&(A.data("dirty",!1),ie.clear()),ee.hide(),ie.show(),N.addClass("wpo-unused-images-trash-view"),!1}),F.on("click",function(){return F.hide(),A.show(),ie.hide(),ee.show(),N.removeClass("wpo-unused-images-trash-view"),F.data("dirty")&&(F.data("dirty",!1),Z.trigger("click")),!1}),j(document).on(de.GET_INFO_START,function(){Q.html("..."),H.html(""),Z.prop("disabled",!0),j("#wp-optimize-nav-tab-wpo_images-unused-contents .wpo_shade").show(),j(".wpo_unused_images_loader").show(),a(!0)}),j(document).on(de.GET_INFO_PROCESS,function(e,i){Q.html(i),te&&H.html(i)}),j(document).on(de.GET_INFO_DONE,function(e,i){j(".wpo_unused_images_loader").hide(),j("#wp-optimize-nav-tab-wpo_images-unused-contents .wpo_shade").hide(),Z.prop("disabled",!1),i&&i.hasOwnProperty("result")&&i.result.hasOwnProperty("output")?Q.html(i.result.output.join("<br>")):Q.html(""),te?(u(i,l),a(!1)):a(!1)}),j(document).on(de.OPTIMIZATION_START,function(){te=!0,j(".wpo_unused_images_loader").show(),a(!0)}),j(document).on(de.OPTIMIZATION_DONE,function(e,i){j(".wpo_unused_images_loader").hide(),a(!1),u(i,l),Q.html(i.result.output),alert(i.result.meta.removed_message)}),R.on("click",function(){0!=j('#wpo_unused_images input[type="checkbox"]:checked').length&&(C(),q.is(":checked")?S(b,"uploads"):b())}),L.on("click",function(){0!=j('#wpo_unused_images input[type="checkbox"]:checked').length&&(C(),q.is(":checked")?S(o,"uploads"):o())}),U.on("click",function(){0!=ie.get_selected_images().length&&(C(),q.is(":checked")?S(n,"uploads"):n())}),D.on("click",function(){0!=ie.get_selected_images().length&&(C(),q.is(":checked")?S(s,"uploads"):s())}),G.on("click",function(){C(),J.is(":checked")?S(k):k()}),Z.on("click",function(e){e.preventDefault(),j(this).prop("disabled")||(ne={},se={},pe={},j(document).trigger(de.GET_INFO_START),I(Q,"images",{support_ajax_get_info:!0,forced:!0}).fail(function(){j(document).trigger(de.GET_INFO_DONE,{})}))}),B.on("click",function(){ee.is_visible()&&ee.select_all(),ie.is_visible()&&ie.select_all()}),Y.on("click",function(){ee.is_visible()&&ee.select_none(),ie.is_visible()&&ie.select_none()}),j("#wp-optimize-nav-tab-wrapper__wpo_images .nav-tab").on("click",function(){i("wpo_images-unused")&&t()}),i("wpo_images-unused")&&t(),$.on("change",function(){var e=P();h(e),d(e)}),j(".wpo_unused_images_switch_view a").on("click",function(){f(j(this).data("mode"))}),W.on("click",".wpo_unused_images_remove_single",function(){var e=j(this),i=e.closest(".wpo_unused_image"),t=j('input[type="checkbox"]',i).attr("value");j("button",i).prop("disabled",!0),z([t]).done(function(){i.remove()})}),W.on("click",".wpo_unused_images_move_to_trash_single",function(){var e=j(this),i=e.closest(".wpo_unused_image"),t=j('input[type="checkbox"]',i).attr("value");j("button",i).prop("disabled",!0),o([t]).done(function(){i.remove()})}),M.on("click",".wpo_unused_images_restore_from_trash_single",function(){var e=j(this),i=e.closest(".wpo_unused_image"),t=j('input[type="checkbox"]',i).attr("value");j("button",i).prop("disabled",!0),s([t],i).done(function(){i.remove()})}),M.on("click",".wpo_unused_images_remove_single_from_trash",function(){var e=j(this),i=e.closest(".wpo_unused_image"),t=j('input[type="checkbox"]',i).attr("value");j("button",i).prop("disabled",!0),n([t],i).done(function(){i.remove()})}),j("#wpo_lazy_load_settings").on("click",".wp-optimize-settings-save",function(){var e=j(this),i=e.next(".wpo_spinner"),t=i.next(".dashicons-yes");i.show(),x(function(){i.hide(),t.removeClass("display-none").show().delay(5e3).fadeOut("fast",function(){t.addClass("display-none")})})}),j("body").append('<div id="wpo-popup-preview"></div>'),j("#wp-optimize-nav-tab-WP-Optimize-optimize-contents").on("click",".wpo-optimization-preview",function(){return T(j(this).data()),!1}),j("#wpo-popup-preview").on("change","#wpo-select-all-preview-rows",function(){var e=j(this).closest("table"),i=j(this).prop("checked");j("input:checkbox",e).each(function(){j(this).is("#wpo-select-all-preview-rows")||j(this).prop("checked",i)})}),j("#remove_all_transients").on("change",function(){var e=j(this).closest("td"),i=j(this).is(":checked");j("a",e).each(function(){j(this).data("remove_all_transients",i)})})};jQuery(document).ready(function(e){function i(e,i){var t="";switch(e){case"wpo_once":t=WP_Optimize_Handlebars.once.handlebars({details:i});break;case"wpo_daily":t=WP_Optimize_Handlebars.daily.handlebars({details:i});break;case"wpo_weekly":t=WP_Optimize_Handlebars.weekly.handlebars({details:i});break;case"wpo_fortnightly":t=WP_Optimize_Handlebars.fortnightly.handlebars({details:i});break;case"wpo_monthly":t=WP_Optimize_Handlebars.monthly.handlebars({details:i})}return t}function t(){0===e(".wpo_scheduled_event:visible").length?(e(".wpo_auto_event_heading_container").hide(),e(".wpo_no_schedules").show()):(e(".wpo_auto_event_heading_container").show(),e(".wpo_no_schedules").hide()),0!==e(".wpo_scheduled_event:visible").length||0!==e(".wpo_auto_event:visible").length||e("#save_settings_reminder").is(":visible")?e(".wpo_no_schedules").hide():e(".wpo_no_schedules").show()}var o=e("#wp-optimize-auto-options"),n=e('input[type="time"]'),s=e('input[type="date"]'),a=(new Date).toISOString().split("T")[0],p=e(".wpo_auto_event:last").data("count")||0;n.each(function(i,t){Modernizr.inputtypes.time||(e(t).timepicker({timeFormat:"H:i"}),e(t).addClass("no_date_time_support"),e(t).on("changeTime",function(){e(this).timepicker("hide")}))}),o.on("focus",'input[type="time"]',function(){var i=e(this).get(0);Modernizr.inputtypes.time||(e(i).timepicker({timeFormat:"H:i"}),e(i).on("changeTime",function(){e(this).timepicker("hide")}))}),o.on("keypress","input",function(e){if(13===e.keyCode)return!1}),s.each(function(i,t){Modernizr.inputtypes.date||(e(t).datepicker({dateFormat:"yy-mm-dd",minDate:0}),e(t).addClass("no_date_time_support"))}),o.on("focus",'input[type="date"]',function(){var i=e(this).get(0);Modernizr.inputtypes.date||e(i).datepicker({dateFormat:"yy-mm-dd",minDate:0})}),0!==e(".wpo_scheduled_event").length?e(".wpo_no_schedules").hide():e(".wpo_no_schedules").show(),e(".wpo_auto_optimizations").select2({placeholder:wpoptimize.select_optimizations}),e(".wpo_auto_optimizations").on("select2:opening select2:closing",function(i){var t=e(this).parent().find(".select2-search__field");t.prop("disabled",!0)}),o.on("change",'select, input[type="date"], input[type="time"]',function(){e("#save_settings_reminder").slideDown(),t()}),e("#wpo-add-event").on("click",function(i){i.preventDefault(),p++;var t=WP_Optimize_Handlebars.optimizations.handlebars({optimizations:wpoptimize.auto_optimizations,count:p}),o=WP_Optimize_Handlebars.schedule_types.handlebars({schedule_types:wpoptimize.schedule_types,count:p}),n=WP_Optimize_Handlebars.action.handlebars({count:p}),s='<div class="wpo_auto_event wpo_cf" data-count="'+p+'">';s+=t+o+n,s+="</div>",e("#wpo_auto_events").prepend(s),e(".wpo_auto_optimizations").select2({placeholder:wpoptimize.select_optimizations}),e(".wpo_auto_optimizations").on("select2:opening select2:closing",function(i){var t=e(this).parent().find(".select2-search__field");t.prop("disabled",!0)})}),o.on("change",".wpo_schedule_type",function(){var t=e(this).closest(".wpo_auto_event"),o=t.data("count")||p,n=e(this).val(),s="";Modernizr.inputtypes.date&&Modernizr.inputtypes.time||(s="no_date_time_support");var _={date:wpoptimize.date,time:wpoptimize.time,day:wpoptimize.day,day_number:wpoptimize.day_number,days:wpoptimize.days,date_value:"",time_value:"00:00",status:wpoptimize.active,status_value:"checked",week_days:wpoptimize.week_days,week:wpoptimize.week,count:o,class_name:s,today:a},r=i(n,_),d=WP_Optimize_Handlebars.status.handlebars({details:_}),u=WP_Optimize_Handlebars.action.handlebars({});e(this).next().html(""),t.find(".wpo_event_status").remove(),t.find(".wpo_event_actions").remove(),""!==r&&e(this).next().html(r),t.append(d+u)}),o.on("click",".wpo_edit_event",function(){var i=e(this).closest(".wpo_scheduled_event");i.hide(),i.next().show(),t()}),o.on("click",".wpo_remove_event",function(){var i=e(this).data("count"),o=confirm(wpoptimize.confirm_remove_task);if(!0===o){var n=e(this).closest(".wpo_scheduled_event"),s=e(this).closest(".wpo_auto_event");i==n.next().data("count")&&(n.next().remove(),n.remove()),i==s.prev().data("count")&&s.prev().remove(),s.remove(),e("#save_settings_reminder").slideDown(),t()}}),e("#database_settings_form").on("wpo-saving-form-data",function(i){var o=!0,n=e("#database_settings_form");n.find(".wpo_auto_optimizations").each(function(){e(this).val()||(o=!1)}),n.find(".wpo_schedule_type").each(function(){e(this).val()||(o=!1)}),!1===o?(n.form_errors.add("missing-fields",""),i.stopImmediatePropagation(),n.find(".wp-optimize-settings-save-results").show().addClass("wpo_alert_notice").text(wpoptimize.fill_all_fields).delay(5e3).fadeOut(3e3,function(){e(this).removeClass("wpo_alert_notice")})):n.form_errors.remove("missing-fields"),e("#save_settings_reminder").slideUp("normal",function(){t()})})});